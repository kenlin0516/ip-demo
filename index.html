<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>取得訪客 IP</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding-top: 50px; }
    #ip { font-size: 2rem; color: #007acc; }
  </style>
</head>
<body>
  <h1>您的 IP 位址是：</h1>
  <div id="ip">載入中…</div>

  <script>
    // 取到 IP
    fetch('https://api.ipify.org?format=json')
      .then(res => res.json())
      .then(data => {
        const ip = data.ip;
        document.getElementById('ip').textContent = ip;

        // 再把 IP 丟到你的 Apps Script
        fetch('https://script.google.com/macros/s/你的-部署ID/exec?ip=' + encodeURIComponent(ip))
          .catch(console.error);
      })
      .catch(err => {
        console.error(err);
        document.getElementById('ip').textContent = '取得失敗';
      });
  </script>
</body>
</html>
